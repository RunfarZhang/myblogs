# FTP服务器

---

1. File Transfer Protocol 文件传输协议

2. 端口号：TCP 20/21

3. FTP工作方式：

   * **选择权在客户机，客户机决定模式；服务器提供主动或者被动模式**
   * **主被动模式，选择权在客户机上；主动或被动模式是在服务器角度**

   1. 主动模式
      * 21 控制端口
      * 20 数据端口
      * <img src="./qmfgwhloanqrxtxibiji/SavedPics/ch12-FTP服务器/image-20200428102845290.png" alt="image-20200428102845290" style="zoom:50%;" />
      * 客户机选择模式、服务器主动，从20发文件到50002
      * 此时，如果有防火墙限制，则需要50002先访问20端口
      * 若使用防火墙（屏蔽了客户机的第二个端口）+主动模式则无法连接
   2. 被动模式
      *  <img src="./qmfgwhloanqrxtxibiji/SavedPics/ch12-FTP服务器/image-20200428103726232.png" alt="image-20200428103726232" style="zoom:50%;" />
      * 21端口+随机端口作为数据传输端口
      * 被动模式就是在建立连接并申请文件后客户机先询问服务器建立通道

   * 若服务器没开防火墙，则可以用任意模式连接；若服务器开了防火墙且开放20、21端口，则应当用主动模式连接。
   * netstat -an，Established表示正在连接并使用

4. 部署FTP服务器

   1. 配置静态FTP
   2. 安装IIS-ftp软件
   3. 使用默认站点或创建新站点

   * 注意：用户最终权限为FTP权限与NTFS权限取交集。
   * 建议：FTP权限全部勾选，然后具体的在NTFS里做！

   4. 去除匿名访问

   * FTPserver.exe（轻量化、傻瓜式）
   * 取交集

* 作业：
  1. 同时发布两个动态网站，并成功分别用域名访问。
  2. 使用IIS实现学校FTP服务器的访问效果。